<!DOCTYPE html>
<html class="no-js" lang="en" data-content_root="./">
<head>
    <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>models_processing &mdash; ForecrypT 0.1.0 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="static/dist/theme.css?v=310cf088" />
      <link rel="stylesheet" type="text/css" href="static/copybutton.css?v=76b2166b" />
            <link rel="index" title="Index" href="genindex.html" />
            <link rel="search" title="Search" href="search.html" />
            <link rel="top" title="ForecrypT 0.1.0 documentation" href="#" />
            <link rel="next" title="How to Manage the config.py Configuration?" href="how_to_manage_config.html" />
            <link rel="prev" title="model_fits" href="model_fits.html" />
    </head>
<body>
    <script type="text/javascript" src="static/dist/blocking.js"></script>
    <header class="container-fluid bg-primary">
        <a class="btn btn-sm btn-light skip-to-content-link" href="#main">Skip to content</a>
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="/"
                        title="Wagtail"
                        class="logo navbar-brand"
                    >
                        <img src="static/img/wagtail-logo-circle.svg" width="45" height="59" alt="Wagtail"
                            class="logo-img"
                        />
                        ForecrypT
                    </a>
                
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" class="searchbox mb-6 px-1" role="search">
    <form id="search-form" action="search.html" autocomplete="off" method="get" role="search">
        <div class="input-group">
            <div class="input-group-prepend">
                <div class="input-group-text border-right-0 bg-white py-3 pl-3 pr-2"><span class="fas fa-search"></span></div>
            </div>
            <input class="form-control py-3 pr-3 pl-1 h-100 border-left-0" type="search" name="q" placeholder="Search documentation" aria-label="Search documentation" id="searchinput" />
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="db_utils.html">db_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">config</a></li>
<li class="toctree-l1"><a class="reference internal" href="main.html">main</a></li>
<li class="toctree-l1"><a class="reference internal" href="forecasting.html">forecasting</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_data.html">get_data</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_fits.html">model_fits</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">models_processing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how_to_manage_config.html">How to Manage the config.py Configuration?</a></li>
<li class="toctree-l1"><a class="reference internal" href="add_custom_model.html">How to Add a Custom Model?</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_ts_source.html">How to Set Up a Custom Time Series Source?</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Schemes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ForecrypT_Python_Internal_Processes.html">ForecrypT Python Internal Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Systems_of_ForecrypT.html">Systems of ForecrypT</a></li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="index.html">Docs</a></li>
        <li class="breadcrumb-item active" aria-current="page">models_processing</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="wagtail-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="https://github.com/dove0dowg/forecrypt/tree/master/docs/models_processing.rst" rel="nofollow">
        <span class="btn-icon"><span class="fab fa-github"></span></span>
        <span class="btn-text">Edit on GitHub</span>
    </a>
    <a class="btn btn-sm btn-light text-decoration-none" href="_sources/models_processing.rst.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main" id="main">
    <section id="module-models_processing">
<span id="models-processing"></span><h1>models_processing<a class="headerlink" href="#module-models_processing" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="models_processing.check_model">
<span class="sig-prename descclassname"><span class="pre">models_processing.</span></span><span class="sig-name descname"><span class="pre">check_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crypto_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#models_processing.check_model" title="Link to this definition">¶</a></dt>
<dd><p>Checks if a model exists and determines if it needs to be updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crypto_id</strong> – e.g. ‘BTC’</p></li>
<li><p><strong>model_name</strong> – e.g. ‘arima’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if model needs update or doesn’t exist, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="models_processing.fit_model_any">
<span class="sig-prename descclassname"><span class="pre">models_processing.</span></span><span class="sig-name descname"><span class="pre">fit_model_any</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#models_processing.fit_model_any" title="Link to this definition">¶</a></dt>
<dd><p>Dynamically fit any model based on model_name.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="models_processing.forecast_in_hour_cycle">
<span class="sig-prename descclassname"><span class="pre">models_processing.</span></span><span class="sig-name descname"><span class="pre">forecast_in_hour_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crypto_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_last_forecast</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#models_processing.forecast_in_hour_cycle" title="Link to this definition">¶</a></dt>
<dd><p>Handle forecasting for a specific hour.</p>
<p>This function checks whether a new forecast is needed based on the elapsed time since the
last forecast. If a forecast is required, the function attempts to load the existing model,
generates predictions for the specified number of hours, and saves the forecast results to the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<em>str</em>) – The name of the model being used for forecasting.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – A dictionary containing configuration parameters for the model.
Must include ‘forecast_frequency’ (time interval in hours between forecasts)
and ‘forecast_hours’ (number of hours to forecast).</p></li>
<li><p><strong>sub_df</strong> (<em>DataFrame</em>) – A pandas DataFrame containing the input data for forecasting.</p></li>
<li><p><strong>current_dt</strong> (<em>datetime</em>) – The current datetime being processed in the hourly cycle.</p></li>
<li><p><strong>crypto_id</strong> (<em>str</em>) – The cryptocurrency identifier (e.g., ‘BTC’, ‘ETH’) for which the forecast is being generated.</p></li>
<li><p><strong>conn</strong> (<em>Connection</em>) – A database connection object used to save the forecast results.</p></li>
<li><p><strong>model_last_forecast</strong> (<em>dict</em>) – A dictionary tracking the last forecast times for each model.
The key is the model name, and the value is the datetime of the last forecast.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – Logs any exceptions that occur during forecasting or saving the forecast.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="models_processing.load_model">
<span class="sig-prename descclassname"><span class="pre">models_processing.</span></span><span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crypto_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#models_processing.load_model" title="Link to this definition">¶</a></dt>
<dd><p>Loads the saved model for the given cryptocurrency and model name.
Path to folder with models determined by config.py/MODELS_DIRECTORY.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crypto_id</strong> – e.g., ‘BTC’</p></li>
<li><p><strong>model_name</strong> – e.g., ‘arima’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the deserialized model object</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>FileNotFoundError</strong> – if the model file does not exist</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="models_processing.process_model_for_hour">
<span class="sig-prename descclassname"><span class="pre">models_processing.</span></span><span class="sig-name descname"><span class="pre">process_model_for_hour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crypto_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_last_retrain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_last_forecast</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#models_processing.process_model_for_hour" title="Link to this definition">¶</a></dt>
<dd><p>Do</p>
<p>Process a single model for a specific cryptocurrency and time interval.
This function handles retraining or loading an existing model, checking whether a forecast is needed,
and generating and saving the forecast.
:param model_name: Name of the model to process.
:type model_name: str
:param params: Configuration parameters for the model, including update interval and forecast frequency.
:type params: dict
:param sub_df: Filtered historical data for the specific time window.
:type sub_df: DataFrame
:param current_dt: The current datetime being processed.
:type current_dt: datetime
:param crypto_id: Identifier for the cryptocurrency (e.g., ‘BTC’, ‘ETH’).
:type crypto_id: str
:param conn: Database connection for saving forecasts.
:type conn: Connection
:param model_last_retrain: Tracks the last retrain time for each model.
:type model_last_retrain: dict
:param model_last_forecast: Tracks the last forecast time for each model.
:type model_last_forecast: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<dl class="simple">
<dt>Logic:</dt><dd><ul class="simple">
<li><p>Filters the input data to ensure sufficient historical coverage.</p></li>
<li><p>Checks whether retraining is needed based on the model’s update interval.</p></li>
<li><p>Either retrains the model or loads an existing one.</p></li>
<li><p>Checks if a forecast is needed based on the model’s forecast frequency.</p></li>
<li><p>Generates a forecast and saves it to the database if required.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="models_processing.retrain_in_hour_cycle">
<span class="sig-prename descclassname"><span class="pre">models_processing.</span></span><span class="sig-name descname"><span class="pre">retrain_in_hour_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crypto_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_last_retrain</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#models_processing.retrain_in_hour_cycle" title="Link to this definition">¶</a></dt>
<dd><p>Handle model retraining for a specific hour.</p>
<p>This function determines whether the model requires retraining based on the elapsed time
since the last retraining. If retraining is necessary, the model is trained using the provided
historical data and saved. If retraining is not required, no action is taken.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<em>str</em>) – The name of the model being processed. This is used for logging and
identifying the model in the database.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – A dictionary containing configuration parameters for the model.
Must include ‘model_update_interval’, which defines the time interval
(in hours) for retraining.</p></li>
<li><p><strong>sub_df</strong> (<em>DataFrame</em>) – A pandas DataFrame containing historical data used for training the model.</p></li>
<li><p><strong>current_dt</strong> (<em>datetime</em>) – The current datetime being processed in the hourly cycle.</p></li>
<li><p><strong>crypto_id</strong> (<em>str</em>) – The cryptocurrency identifier (e.g., ‘BTC’, ‘ETH’) for which the model is being processed.</p></li>
<li><p><strong>model_last_retrain</strong> (<em>dict</em>) – A dictionary tracking the last retrain times for each model.
The key is the model name, and the value is the datetime of the last retraining.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – Logs any exceptions that occur during model fitting or saving.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="models_processing.save_model">
<span class="sig-prename descclassname"><span class="pre">models_processing.</span></span><span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crypto_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_fit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#models_processing.save_model" title="Link to this definition">¶</a></dt>
<dd><p>Saves the given model to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crypto_id</strong> – e.g. ‘BTC’</p></li>
<li><p><strong>model_name</strong> – e.g. ‘arima’</p></li>
<li><p><strong>model_fit</strong> – fitted model object</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>

</main>
                        <nav aria-label="Page navigation" class="py-4 my-5 clearfix font-weight-bold border-top">
    <a class="float-left" href="model_fits.html" title="Previous">
        <span aria-hidden="true">←&nbsp;</span>model_fits
    </a>
    <a class="float-right" href="how_to_manage_config.html" title="Next">
        How to Manage the config.py Configuration? <span aria-hidden="true">&nbsp;→</span>
    </a>
</nav>
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">models_processing</a><ul>
<li><a class="reference internal" href="#models_processing.check_model"><code class="docutils literal notranslate"><span class="pre">check_model()</span></code></a></li>
<li><a class="reference internal" href="#models_processing.fit_model_any"><code class="docutils literal notranslate"><span class="pre">fit_model_any()</span></code></a></li>
<li><a class="reference internal" href="#models_processing.forecast_in_hour_cycle"><code class="docutils literal notranslate"><span class="pre">forecast_in_hour_cycle()</span></code></a></li>
<li><a class="reference internal" href="#models_processing.load_model"><code class="docutils literal notranslate"><span class="pre">load_model()</span></code></a></li>
<li><a class="reference internal" href="#models_processing.process_model_for_hour"><code class="docutils literal notranslate"><span class="pre">process_model_for_hour()</span></code></a></li>
<li><a class="reference internal" href="#models_processing.retrain_in_hour_cycle"><code class="docutils literal notranslate"><span class="pre">retrain_in_hour_cycle()</span></code></a></li>
<li><a class="reference internal" href="#models_processing.save_model"><code class="docutils literal notranslate"><span class="pre">save_model()</span></code></a></li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
            <div class="text-center">
                    &copy; Copyright 2024, dove0dowg
            </div>
            <div class="text-center text-white-50 font-italic mt-3">
                <small>
                    Created using
                    <a href="https://github.com/wagtail/sphinx_wagtail_theme" rel="nofollow" target="_blank">
                        Sphinx Wagtail Theme 6.4.0
                    </a>
                    and
                    <a href="https://www.sphinx-doc.org/" rel="nofollow" target="_blank">
                        Sphinx 8.1.3
                    </a>
                </small>
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script src="static/documentation_options.js?v=01f34227"></script>
        <script src="static/doctools.js?v=9bcbadda"></script>
        <script src="static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="static/clipboard.min.js?v=a7894cd8"></script>
        <script src="static/copybutton.js?v=f281be69"></script>
        <script type="text/javascript" src="static/dist/theme.js"></script>
        <script type="text/javascript" src="static/dist/vendor.js"></script>
        <script type="text/javascript" src="static/searchtools.js"></script>
        <script type="text/javascript" src="static/language_data.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() { Search.loadIndex("searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>